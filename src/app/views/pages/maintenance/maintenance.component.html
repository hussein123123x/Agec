<!-- ุนููุงู ุงูุตูุญุฉ -->
<h3 class="mb-4">๐ ุฅุฏุงุฑุฉ ุงูุตูุงูุฉ ูุงูุฏุนู ุงูููู</h3>

<!-- ุงูุฅุญุตุงุฆูุงุช -->
<c-row class="mb-4 text-center">
  <c-col sm="6" md="3">
    <c-widget-stat-c color="primary" [value]="totalTickets" title="ุฅุฌูุงูู ุงูุจูุงุบุงุช" inverse></c-widget-stat-c>
  </c-col>
  <c-col sm="6" md="3">
    <c-widget-stat-c color="warning" [value]="inProgressTickets" title="ููุฏ ุงููุนุงูุฌุฉ" inverse></c-widget-stat-c>
  </c-col>
  <c-col sm="6" md="3">
    <c-widget-stat-c color="success" [value]="closedTickets" title="ูุบููุฉ" inverse></c-widget-stat-c>
  </c-col>
  <c-col sm="6" md="3">
    <c-widget-stat-c color="danger" [value]="urgentTickets" title="ุจูุงุบุงุช ุนุงุฌูุฉ" inverse></c-widget-stat-c>
  </c-col>
</c-row>

<!-- ูููุฐุฌ ุชูุฏูู ุจูุงุบ ุฌุฏูุฏ -->
<c-card class="mb-4">
  <c-card-header>
    <strong>๐จ ุชูุฏูู ุจูุงุบ ุฌุฏูุฏ</strong>
  </c-card-header>
  <c-card-body>
    <form [formGroup]="reportForm" (ngSubmit)="submitReport()">
      <div class="row mb-3">
        <div class="col-md-6">
          <label>ุงูุนููุงู</label>
          <input formControlName="title" class="form-control" placeholder="ูุซุงู: ุชููู ุงูุทุงุจุนุฉ" />
        </div>
        <div class="col-md-6">
          <label>ููุน ุงููุดููุฉ</label>
          <select formControlName="type" class="form-select">
            <option>ุจุฑูุฌูุฉ</option>
            <option>ุนุชุงุฏ</option>
            <option>ุฃุฎุฑู</option>
          </select>
        </div>
      </div>

      <div class="row mb-3">
        <div class="col-md-6">
          <label>ุงูุฃููููุฉ</label>
          <select formControlName="priority" class="form-select">
            <option>ุนุงููุฉ</option>
            <option>ูุชูุณุทุฉ</option>
            <option>ููุฎูุถุฉ</option>
          </select>
        </div>
        <div class="col-md-6">
          <label>ุงููุณู ุงููุชุถุฑุฑ</label>
          <input formControlName="department" class="form-control" placeholder="ูุซุงู: ูุณู ุงูุฅูุชุงุฌ" />
        </div>
      </div>

      <div class="mb-3">
        <label>ุงููุตู</label>
        <textarea formControlName="description" class="form-control" rows="3"></textarea>
      </div>

      <button class="btn btn-primary" type="submit">ุฅุฑุณุงู ุงูุจูุงุบ</button>
    </form>
  </c-card-body>
</c-card>

<!-- ููุชุฑุฉ -->
<div class="d-flex justify-content-end mb-3">
  <select class="form-select w-auto" [(ngModel)]="statusFilter">
    <option value="">ูู ุงูุญุงูุงุช</option>
    <option value="open">ููุชูุญุฉ</option>
    <option value="in_progress">ููุฏ ุงููุนุงูุฌุฉ</option>
    <option value="closed">ูุบููุฉ</option>
  </select>
</div>

<!-- ูุงุฆูุฉ ุงูุชุฐุงูุฑ ุนูู ุดูู ุจุทุงูุงุช -->
<c-row>
  <c-col md="4" *ngFor="let ticket of filteredTickets()">
    <c-card class="mb-3 shadow-sm">
      <c-card-body>
        <h5 class="card-title mb-2">๐ง {{ ticket.title }}</h5>
        <p class="mb-1"><strong>ุงููุณู:</strong> {{ ticket.department }}</p>
        <p class="mb-1"><strong>ุงูุญุงูุฉ:</strong> <c-badge [color]="getStatusColor(ticket.status)">{{ ticket.status }}</c-badge></p>
        <p class="mb-1"><strong>ุงูุฃููููุฉ:</strong> {{ ticket.priority }}</p>
        <p class="mb-1"><strong>ุงูููู ุงููุณุคูู:</strong> {{ ticket.technician || 'ุบูุฑ ูุนูู' }}</p>
        <p class="small text-muted">๐ ุชุงุฑูุฎ ุงูุฅุจูุงุบ: {{ ticket.createdAt }}</p>
        <button class="btn btn-sm btn-outline-primary" (click)="viewTicket(ticket)">ุนุฑุถ ุงูุชูุงุตูู</button>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<!-- ุชูุงุฑูุฑ ูุฑุฆูุฉ -->
<c-card class="mt-4 mb-4">
  <c-card-header>
    <strong>๐ ุชูุงุฑูุฑ ุงูุฃุนุทุงู ูุงูุตูุงูุฉ</strong>
  </c-card-header>
  <c-card-body>
    <div class="row">
      <div class="col-md-6">
        <canvas #reportChart style="max-height: 300px;"></canvas>
      </div>
      <div class="col-md-6">
        <ul class="list-group">
          <li class="list-group-item d-flex justify-content-between">
            <span>ุฃูุซุฑ ููุน ุนุทู</span> <strong>{{ mostCommonIssue }}</strong>
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>ุฃูุซุฑ ูุณู ุชุถุฑุฑูุง</span> <strong>{{ mostAffectedDept }}</strong>
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>ูุชูุณุท ููุช ุงูุญู</span> <strong>{{ avgResolutionTime }} ุณุงุนุฉ</strong>
          </li>
        </ul>
      </div>
    </div>
  </c-card-body>
</c-card>

<!-- Timeline ุจุณูุท -->
<c-card>
  <c-card-header>
    <strong>๐ ุณุฌู ุงูุฃุญุฏุงุซ ุงููููุฉ</strong>
  </c-card-header>
  <c-card-body>
    <ul class="list-group list-group-flush">
      <li class="list-group-item" *ngFor="let event of ticketHistory">
        {{ event.time }} - {{ event.action }}
      </li>
    </ul>
  </c-card-body>
</c-card>
