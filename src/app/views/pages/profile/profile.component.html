<div class="container my-4">

  <!-- ุฑุฃุณ ุงูุตูุญุฉ -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="text-primary fw-bold">ุงูููู ุงูุดุฎุตู</h4>
    <div class="d-flex gap-2">
        <!-- <button class="btn btn-outline-primary" (click)="requestLeave()"> ุทูุจ ุฅุฌุงุฒุฉ</button>
        <button class="btn btn-outline-success" (click)="requestLoan()"> ุทูุจ ุณููุฉ</button> -->
        <button class="btn btn-outline-secondary" (click)="requestLeave()"> ุชุนุฏูู ุงูุจูุงูุงุช</button>
    </div>
  </div>


  <!-- ุตูุฑุฉ ูุงุณู -->
  <div class="text-center mb-4" style="
    align-items: center;
    justify-content: center;
    display: flex;
    flex-direction: column;
">
    <img [src]="profile.image || 'assets/images/user.png'" class="rounded-circle border" style="width: 120px; height: 120px; object-fit: cover;">
    <h5 class="mt-2 fw-bold">{{ profile.name }}</h5>
    <p class="text-muted">{{ profile.role }}</p>
  </div>

  <!-- ุจูุงูุงุช ุฃุณุงุณูุฉ -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card shadow-sm p-3">
        <h6 class="text-secondary fw-bold mb-3">ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h6>
        <p><strong>ุงููุงุชู:</strong> {{ profile.phone }}</p>
        <p><strong>ุงูุจุฑูุฏ:</strong> {{ profile.email }}</p>
        <p><strong>ุงูุนููุงู:</strong> {{ profile.address }}</p>
        <p><strong>ุชุงุฑูุฎ ุงูุงูุถูุงู:</strong> {{ profile.joinDate }}</p>
      </div>
    </div>

    <!-- ุงูุญุถูุฑ ูุงูุงูุตุฑุงู -->
    <div class="col-md-6">
      <div class="card shadow-sm p-3">
        <h6 class="text-secondary fw-bold mb-3">ุงูุญุถูุฑ ูุงูุงูุตุฑุงู</h6>
        <p><strong>ุฃูุงู ุงูุญุถูุฑ:</strong> {{ profile.attendanceDays }}</p>
        <p><strong>ุฃูุงู ุงูุบูุงุจ:</strong> {{ profile.absenceDays }}</p>
        <p><strong>ุฃูุงู ุงูุชุฃุฎูุฑ:</strong> {{ profile.delays }}</p>
        <p><strong>ุณุงุนุงุช ุงูุนูู ุนูู ุงููุธุงู:</strong> {{ profile.totalWorkHours }} ุณุงุนุฉ</p>
      </div>
    </div>
  </div>




  <h5 class="text-primary fw-bold mt-4 mb-3">ุงููุนูููุงุช ุงูุฅุถุงููุฉ</h5>
<div class="row mb-4">

  <!-- ุงูุญุงูุฉ ุงูุชุฃููููุฉ ูุงูุชุนููู -->
  <div class="col-md-6">
    <div class="card shadow-sm p-3">
      <h6 class="text-secondary fw-bold mb-3">ุงูุจูุงูุงุช ุงูููููุฉ</h6>
      <p><strong>ุงูุญุงูุฉ ุงูุชุฃููููุฉ:</strong> {{ profile.insuranceStatus }}</p>
      <p><strong>ุงูุฏุฑุฌุฉ ุงูุนูููุฉ:</strong> {{ profile.educationLevel }}</p>

      <div *ngIf="profile.certificates?.length">
        <h6 class="text-muted small mt-3">ุงูุดูุงุฏุงุช ูุงูุฏูุฑุงุช:</h6>
        <ul class="list-unstyled">
          <li *ngFor="let cert of profile.certificates">
            ๐ {{ cert.title }} - {{ cert.date }}
          </li>
        </ul>
      </div>

      <div *ngIf="profile.languages?.length">
        <h6 class="text-muted small mt-3">ุงููุบุงุช ุงูููุชุณุจุฉ:</h6>
        <p>{{ profile.languages.join('ุ ') }}</p>
      </div>
    </div>
  </div>

  <!-- ูุนูููุงุช ุงูุนุงุฆูุฉ ูุงูุนููุงู -->
  <div class="col-md-6">
    <div class="card shadow-sm p-3">
      <h6 class="text-secondary fw-bold mb-3">ูุนูููุงุช ุดุฎุตูุฉ</h6>

      <p><strong>ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ:</strong> {{ profile.familyInfo.maritalStatus }}</p>
      <p><strong>ุนุฏุฏ ุงููุนุงููู:</strong> {{ profile.familyInfo.dependents }}</p>

      <div>
        <h6 class="text-muted small">ุฌูุฉ ุงูุงุชุตุงู ููุทูุงุฑุฆ:</h6>
        <p>
          {{ profile.familyInfo.emergencyContact.name }} ({{ profile.familyInfo.emergencyContact.relation }})<br>
          ๐ {{ profile.familyInfo.emergencyContact.phone }}
        </p>
      </div>

      <div>
        <h6 class="text-muted small">ุนููุงู ุงูุณูู:</h6>
        <p>
          {{ profile.residence.governorate }} - {{ profile.residence.city }}<br>
          {{ profile.residence.street }}
        </p>
      </div>
    </div>
  </div>

</div>

<br>
<br>

<div class="d-flex flex-wrap gap-2 align-items-center flex-grow-1 justify-content-between ">
  <h5 class="text-primary fw-bold mt-4 mb-3">ุชููู ุงูุงุฏุงุก</h5>
  <mat-form-field appearance="fill" class="w-full">
          <mat-label>ุชุญุฏูุฏ ูุฏุฉ ุฒูููุฉ</mat-label>
          <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
              <input matStartDate formControlName="start" placeholder="ูู ุชุงุฑูุฎ">
              <input matEndDate formControlName="end" placeholder="ุฅูู ุชุงุฑูุฎ">
          </mat-date-range-input>
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-date-range-picker #picker>
              <mat-datepicker-actions>
              <div class="d-flex justify-content-between mt-3 px-3 pb-2">
                  <button matDatepickerCancel class="btn btn-sm btn-outline-secondary">ุฅูุบุงุก</button>
                  <button matDatepickerApply class="btn btn-sm btn-primary" (click)="applyDateFilter()">ุชุทุจูู</button>
              </div>
              </mat-datepicker-actions>
          </mat-date-range-picker>
          </mat-form-field>
</div>

  <!-- ุงูุฅุญุตุงุกุงุช ูุงูุฑุณูู -->
  <div class="row mb-4">

  <!-- Current Month Rating -->
  <div class="col-md-6">
    <div class="card shadow-sm p-3 text-center">
      <h6 class="text-secondary mb-3">ุชูููู ุงูุดูุฑ ุงูุญุงูู</h6>

      <div class="bg-light rounded p-3">
        <h4 class="text-success mb-3">
          {{ profile.rating }}%
        </h4>
        <ul class="list-unstyled text-start text-muted">
          <li>โ๏ธ ุงูุญุถูุฑ ุงูููุชุธู: +5 ููุงุท</li>
          <li>โ๏ธ ุงูุงูุชุฒุงู ุจุงูููุงุนูุฏ: +3 ููุงุท</li>
          <li>โ๏ธ ุงูุฃุฏุงุก ุงูููุชุงุฒ: +2 ููุงุท</li>
          <li>โ ุงูุบูุงุจ: -1 ููุงุท</li>
          <li>โ ุงูุชุงุฎูุฑ: -1 ููุงุท</li>
        </ul>
      </div>

      <p class="text-muted mt-3">{{ profile.feedback }}</p>
    </div>
  </div>

  <!-- Cumulative Rating -->
  <div class="col-md-6">
    <div class="card shadow-sm p-3">
      <h6 class="text-secondary mb-3">ุงูุชูููู ุงูุชุฑุงููู ุฎูุงู ุงูุดููุฑ</h6>

      <div class="bg-light rounded p-3">
        <h5 class="text-primary">ุฅุฌูุงูู ุงูุชูููู: {{ profile.rating - 33 }}%</h5>
        <p class="text-muted mt-2">ุชุฑุงูู ุงูููุงุท ูู ุจุฏุงูุฉ ุงูุณูุฉ ุญุชู ุงูุขู</p>

        <ul class="list-unstyled text-muted">
          <li>ููุงูุฑ: 30 % </li>
          <li>ูุจุฑุงูุฑ: 59 % </li>
          <li>ูุงุฑุณ:  60 % </li>
          <li>ุฃุจุฑูู: 88 % </li>
          <li>ูุงูู: 30 % </li>
          <li>ููููู: 42 % </li>
        </ul>
      </div>

    </div>
  </div>
</div>


  <h5 class="text-primary fw-bold mt-4 mb-3">ุงูุงุฌุงุฒุงุช</h5>
  <div class="row mb-4">
    
    <!-- ุงูุฅุฌุงุฒุงุช -->
    <div class="col-md-6">
      <div class="card shadow-sm p-3">
        <h6 class="text-secondary fw-bold mb-3">ุงูุฅุฌุงุฒุงุช</h6>
        <p><strong>ุฑุตูุฏ ุงูุฅุฌุงุฒุงุช:</strong> {{ profile.leaveBalance }} ููู</p>
        <div *ngIf="profile.upcomingLeaves.length">
          <h6 class="text-muted small">ุฅุฌุงุฒุงุช ูุงุฏูุฉ:</h6>
          <ul class="list-unstyled">
            <li *ngFor="let leave of profile.upcomingLeaves">
              ๐ {{ leave.date }} - {{ leave.reason }}
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ุงูุบูุงุจุงุช -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3">
        <h6 class="text-secondary fw-bold mb-3">ุงูุบูุงุจุงุช</h6>
        <p><strong>ุนุฏุฏ ุฃูุงู ุงูุบูุงุจ:</strong> {{ profile.delays }} ููู</p>
        <div *ngIf="profile.absentsDays.length">
          <h6 class="text-muted small">ุฅุฌุงุฒุงุช ูุงุฏูุฉ:</h6>
          <ul class="list-unstyled">
            <li *ngFor="let leave of profile.absentsDays">
              ๐ {{ leave.date }} - {{ leave.reason }}
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ุงูุชุฃุฎูุฑุงุช -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3">
        <h6 class="text-secondary fw-bold mb-3">ุงูุชุฃุฎูุฑุงุช</h6>
        <p><strong>ุนุฏุฏ ุฃูุงู ุงูุชุฃุฎูุฑ:</strong> {{ profile.delays }} ููู</p>
        <div *ngIf="profile.upcomingLeaves.length">
          <h6 class="text-muted small">ุงูุงู ุงูุชุฃุฎูุฑ:</h6>
          <ul class="list-unstyled">
            <li *ngFor="let leave of profile.delaysDays">
              ๐ {{ leave.date }} - {{ leave.reason }}
            </li>
          </ul>
        </div>
      </div>
    </div>


    

  </div>

  <h5 class="text-primary fw-bold mt-4 mb-3"> ุงูุฑุงุชุจ ูุงูุญูุงูุฒ</h5>

<div class="row">

  <!-- ุงูุณูู -->
  <div class="col-md-6 mb-4">
    <div class="card shadow-sm p-3 h-100">
      <h6 class="text-secondary fw-bold mb-3">ุงูุณูู ูู ุงูุฑุงุชุจ</h6>

      <p><strong>ุงูุฑุงุชุจ ุงูุดูุฑู:</strong> {{ profile.salary }} ุฌููู</p>
      <p><strong>ุฅุฌูุงูู ุงูุณูู:</strong> {{ getTotalLoans() }} ุฌููู</p>
      <p><strong>ุงููุชุจูู ูู ุงูุฑุงุชุจ:</strong> 
        {{ profile.salary - getTotalLoans() }} ุฌููู
      </p>

      <!-- ุดุฑูุท ููุถุญ ุงููุชุจูู ููุณุจุฉ -->
      <div class="progress mb-3" style="height: 20px;">
        <div class="progress-bar bg-success" 
             role="progressbar" 
             [style.width.%]="getRemainingSalaryPercentage()"
             aria-valuemin="0" 
             aria-valuemax="100">
          {{ getRemainingSalaryPercentage() }}%
        </div>
      </div>

      <hr>

      <!-- ุฌุฏูู ุงูุณูู -->
      <table class="table table-sm table-bordered">
        <thead class="table-light">
          <tr>
            <th>ุงูุชุงุฑูุฎ</th>
            <th>ุงููุจูุบ</th>
            <th>ุงูุญุงูุฉ</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let loan of profile.loans">
            <td>{{ loan.date }}</td>
            <td>{{ loan.amount }} ุฌููู</td>
            <td>
              <span [ngClass]="{
                'text-success': loan.status === 'ูุฏููุนุฉ',
                'text-danger': loan.status !== 'ูุฏููุนุฉ'
              }">{{ loan.status }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ุงูุญูุงูุฒ -->
  <div class="col-md-6 mb-4">
    <div class="card shadow-sm p-3 h-100">
      <h6 class="text-secondary fw-bold mb-3">ุณุฌู ุงูุญูุงูุฒ ูุงูููุงูุขุช</h6>

      <!-- ูุฌููุน ุงูุญูุงูุฒ -->
      <p><strong>ุฅุฌูุงูู ุงูุญูุงูุฒ:</strong> 
        {{ getTotalBonuses() }} ุฌููู
      </p>

      <table class="table table-sm table-striped">
        <thead class="table-light">
          <tr>
            <th>ุงูุชุงุฑูุฎ</th>
            <th>ุงููุตู</th>
            <th>ุงููููุฉ</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let bonus of profile.bonuses">
            <td>{{ bonus.date }}</td>
            <td>{{ bonus.title }}</td>
            <td>{{ bonus.amount }} ุฌููู</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ุงูุฎุตููุงุช ูุงูุฌุฒุงุกุงุช -->
  <div class="col-md-6 mb-4">
    <div class="card shadow-sm p-3 h-100">
      <h6 class="text-secondary fw-bold mb-3">ุณุฌู ุงูุฎุตููุงุช ูุงูุฌุฒุงุกุงุช</h6>

      <!-- ูุฌููุน ุงูุฎุตููุงุช -->
      <p><strong>ุฅุฌูุงูู ุงูุฎุตููุงุช:</strong> 
        {{ getDeductionsTotal() }} ุฌููู
      </p>

      <table class="table table-sm table-striped">
        <thead class="table-light">
          <tr>
            <th>ุงูุชุงุฑูุฎ</th>
            <th>ุงูุณุจุจ</th>
            <th>ุงููููุฉ</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let d of profile.deductions">
            <td>{{ d.date }}</td>
            <td>{{ d.reason }}</td>
            <td class="text-danger">-{{ d.amount }} ุฌููู</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

    <h5 class="text-primary fw-bold mt-4 mb-3"> ุงูุงุญุฏุงุซ</h5>

  <div class="col-md-6 mb-4">
  <div class="card shadow-sm p-3 h-100">
    <h6 class="text-secondary fw-bold mb-3">ุณุฌู ุงูุญุถูุฑ ูุงููุฃููุฑูุงุช</h6>

    <!-- ุนุฏุฏ ุงูุฃูุงู ุฃู ุงูุฃุญุฏุงุซ -->
    <p><strong>ุฅุฌูุงูู ุงูุฃุญุฏุงุซ:</strong> 
      {{ profile.events?.length || 0 }} ุญุฏุซ
    </p>

    <table class="table table-sm table-striped">
      <thead class="table-light">
        <tr>
          <th>ุงูุชุงุฑูุฎ</th>
          <th>ุงูููุน</th>
          <th>ุงูุชูุงุตูู</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let e of profile.events">
          <td>{{ e.date }}</td>
          <td>
            <span [ngClass]="{
              'text-success': e.type === 'ุญุถูุฑ',
              'text-primary': e.type === 'ูุฃููุฑูุฉ',
              'text-warning': e.type === 'ุงูุตุฑุงู ูุจูุฑ'
            }">
              {{ e.type }}
            </span>
          </td>
          <td>{{ e.details }}</td>
        </tr>
      </tbody>
    </table>
    <h6 class="text-danger">ุธููุฑ ูู ุตูุญุฉ ุงูุงุญุฏุงุซ ุนูุฏ ุงูุชุงุฎูุฑ ุงู ุงูุฑุญูู ูุจูุฑุง ุจุนุฏ ุงูุณุงุนุฉ 7:30 ู ุงูุฑุญูู ุจุนุฏ ุงูุณุงุนุฉ 4</h6>
  </div>
</div>


</div>


</div>
